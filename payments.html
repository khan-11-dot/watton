<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Payments & Wages - Watton Tobacco</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
    <link href="../css/style.css" rel="stylesheet"/>
    <link href="../css/navigation.css" rel="stylesheet"/>
    <style>
        :root {
            --neon-green: #00ff00;
            --neon-pink: #ff00ff;
            --dark-bg: #121212;
            --card-bg: #1e1e1e;
        }

        body {
            background-color: var(--dark-bg);
            color: #ffffff;
        }

        .navbar {
            background: rgba(0, 0, 0, 0.7) !important;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: none !important;
            box-shadow: none !important;
        }

        .nav-link, .navbar-brand {
            color: var(--neon-green) !important;
            text-shadow: 0 0 10px var(--neon-green);
        }

        .nav-link:hover, .navbar-brand:hover {
            color: var(--neon-pink) !important;
            text-shadow: 0 0 10px var(--neon-pink),
                       0 0 20px var(--neon-pink),
                       0 0 30px var(--neon-pink);
        }

        .page-header {
            background: var(--dark-bg);
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--neon-green);
        }

        .page-header h1 {
            color: var(--neon-green);
            text-shadow: 0 0 10px var(--neon-green);
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green);
        }

        .table {
            color: #ffffff;
        }

        .form-control, .form-select {
            background: var(--dark-bg);
            border: 1px solid var(--neon-green);
            color: #ffffff;
        }

        .form-control:focus, .form-select:focus {
            background: var(--dark-bg);
            border-color: var(--neon-pink);
            color: #ffffff;
            box-shadow: 0 0 10px var(--neon-pink);
        }

        .btn-primary {
            background: transparent;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            text-shadow: 0 0 10px var(--neon-green);
        }

        .btn-primary:hover {
            background: var(--neon-green);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--neon-green);
        }

        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--neon-green);
        }

        .modal-header {
            border-bottom: 1px solid var(--neon-green);
        }

        .modal-footer {
            border-top: 1px solid var(--neon-green);
        }

        .badge {
            font-size: 0.9rem;
            padding: 0.5rem 0.8rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="../index.html">Watton Tobacco</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../hand-stem.html">Hand Stem</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../labor-registration.html">Labor Registration</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../staff-apply.html">Apply for Staff</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="warehousesLink">Warehouses</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="centersLink">Purchase Centers</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="./index.html">Admin</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../staff/index.html">Staff</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../creator.html">Developer</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../contact.html">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <header class="page-header mt-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1>Payments & Wages</h1>
                </div>
                <div class="col-md-6">
                    <div class="d-flex gap-3 justify-content-md-end mt-3 mt-md-0">
                        <button class="btn btn-primary" onclick="showAddPaymentForm()">
                            <i class="fas fa-plus"></i> Add New Payment
                        </button>
                        <button class="btn btn-primary" onclick="exportPayments()">
                            <i class="fas fa-file-export"></i> Export
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Filters -->
        <div class="card mb-4">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <select class="form-select" id="paymentType">
                            <option value="all">All Types</option>
                            <option value="labor">Labor Wages</option>
                            <option value="staff">Staff Salary</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select class="form-select" id="paymentStatus">
                            <option value="all">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="paid">Paid</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="paymentSearch" placeholder="Search by Name/ID">
                    </div>
                </div>
            </div>
        </div>

        <!-- Payments Table -->
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="paymentsTableBody">
                            <!-- Payments will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Payment Modal -->
    <div class="modal fade" id="addPaymentModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Payment</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addPaymentForm">
                        <div class="mb-3">
                            <label class="form-label">Payment Type</label>
                            <select class="form-select" name="type" required>
                                <option value="labor">Labor Wages</option>
                                <option value="staff">Staff Salary</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Worker/Staff ID</label>
                            <input type="text" class="form-control" name="workerId" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Name</label>
                            <input type="text" class="form-control" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Amount</label>
                            <input type="number" class="form-control" name="amount" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Payment Date</label>
                            <input type="date" class="form-control" name="date" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Add Payment</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Load payments when page loads
        window.onload = function() {
            loadPayments();
        };

        function loadPayments() {
            const payments = JSON.parse(localStorage.getItem('payments')) || [];
            const tableBody = document.getElementById('paymentsTableBody');
            const paymentType = document.getElementById('paymentType').value;
            const paymentStatus = document.getElementById('paymentStatus').value;
            const searchTerm = document.getElementById('paymentSearch').value.toLowerCase();
            
            // Filter payments
            const filteredPayments = payments.filter(payment => {
                const matchesType = paymentType === 'all' || payment.type === paymentType;
                const matchesStatus = paymentStatus === 'all' || payment.status === paymentStatus;
                const matchesSearch = payment.name.toLowerCase().includes(searchTerm) || 
                                    payment.id.toLowerCase().includes(searchTerm);
                
                return matchesType && matchesStatus && matchesSearch;
            });
            
            // Clear table
            tableBody.innerHTML = '';
            
            // Add filtered payments
            filteredPayments.forEach(payment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${payment.date}</td>
                    <td>${payment.id}</td>
                    <td>${payment.name}</td>
                    <td>${payment.type === 'labor' ? 'Labor Wages' : 'Staff Salary'}</td>
                    <td>Rs. ${payment.amount}</td>
                    <td>
                        <span class="badge ${payment.status === 'paid' ? 'bg-success' : 'bg-warning'}">
                            ${payment.status}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="markAsPaid('${payment.id}')">
                            <i class="fas fa-check"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deletePayment('${payment.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function showAddPaymentForm() {
            const modal = new bootstrap.Modal(document.getElementById('addPaymentModal'));
            modal.show();
        }

        function handleAddPayment(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            const payment = {
                id: 'PAY-' + Date.now(),
                type: formData.get('type'),
                workerId: formData.get('workerId'),
                name: formData.get('name'),
                amount: formData.get('amount'),
                date: formData.get('date'),
                status: 'pending'
            };
            
            const payments = JSON.parse(localStorage.getItem('payments')) || [];
            payments.push(payment);
            localStorage.setItem('payments', JSON.stringify(payments));
            
            bootstrap.Modal.getInstance(document.getElementById('addPaymentModal')).hide();
            loadPayments();
            
            alert('Payment added successfully!');
        }

        function markAsPaid(paymentId) {
            const payments = JSON.parse(localStorage.getItem('payments')) || [];
            const paymentIndex = payments.findIndex(p => p.id === paymentId);
            
            if (paymentIndex !== -1) {
                payments[paymentIndex].status = 'paid';
                localStorage.setItem('payments', JSON.stringify(payments));
                loadPayments();
            }
        }

        function deletePayment(paymentId) {
            if (confirm('Are you sure you want to delete this payment?')) {
                const payments = JSON.parse(localStorage.getItem('payments')) || [];
                const filteredPayments = payments.filter(p => p.id !== paymentId);
                localStorage.setItem('payments', JSON.stringify(filteredPayments));
                loadPayments();
            }
        }

        function exportPayments() {
            const payments = JSON.parse(localStorage.getItem('payments')) || [];
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Date,ID,Name,Type,Amount,Status\n"
                + payments.map(p => `${p.date},${p.id},${p.name},${p.type},${p.amount},${p.status}`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "payments.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Add event listeners
        document.getElementById('addPaymentForm').addEventListener('submit', handleAddPayment);
        document.getElementById('paymentType').addEventListener('change', loadPayments);
        document.getElementById('paymentStatus').addEventListener('change', loadPayments);
        document.getElementById('paymentSearch').addEventListener('input', loadPayments);
    </script>
</body>
</html> 